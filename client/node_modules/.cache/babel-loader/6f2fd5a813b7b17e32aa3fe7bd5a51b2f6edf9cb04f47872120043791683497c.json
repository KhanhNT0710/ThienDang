{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import\"./style.scss\";import{actFetchAllPaymentBills}from\"../../redux/features/payment/paymentSlice\";import{Button,InputNumber}from\"antd\";import CartPurchase from\"../CartPurchase\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PurchaseHistory=()=>{const dispatch=useDispatch();const{paymentBills}=useSelector(state=>state.payment);const userInfo=useSelector(state=>state.user.userInfo);const[isModalOpen,setIsModalOpen]=useState(false);const[cartsInCheckoutBills,setCartsInCheckoutBills]=useState([]);useEffect(()=>{if(!userInfo.id){return;}dispatch(actFetchAllPaymentBills({userId:userInfo.id}));// eslint-disable-next-line\n},[userInfo.id]);const checkoutBillsClone=[...paymentBills];const showModal=id=>{setIsModalOpen(true);const indexThisBills=checkoutBillsClone.findIndex(_cart=>{return _cart.id===id;});setCartsInCheckoutBills(checkoutBillsClone[indexThisBills].carts);};const handleOk=()=>{setIsModalOpen(false);};const handleCancel=()=>{setIsModalOpen(false);};const formatNumber=num=>{let numString=\"\";while(num>0){let div=num%1000;num=Math.floor(num/1000);if(num!==0){if(div<10){div=\"00\"+div;}else if(div<100){div=\"0\"+div;}numString=\".\"+div+numString;}else{numString=div+numString;}}return numString;};const renderDetail=paymentBills=>{console.log(paymentBills,\"cartsInPaymentBillscartsInPaymentBills\");return paymentBills===null||paymentBills===void 0?void 0:paymentBills.map(_cart=>{return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"cart-page-shop-table__img-product\",children:/*#__PURE__*/_jsx(\"p\",{children:_cart.orderNumber})}),/*#__PURE__*/_jsx(\"td\",{className:\"cart-page-shop-table__name-product\",children:/*#__PURE__*/_jsx(\"p\",{className:\"name\",children:_cart.dateOfBill})}),/*#__PURE__*/_jsx(\"td\",{className:\"cart-page-shop-table__price-product\",children:/*#__PURE__*/_jsx(\"p\",{className:\"name\",children:_cart.payment})}),/*#__PURE__*/_jsx(\"td\",{className:\"cart-page-shop-table__subtotal-product\",children:_cart.totalMoney}),/*#__PURE__*/_jsx(\"td\",{className:\"cart-page-shop-table__subtotal-product\",children:/*#__PURE__*/_jsx(Button,{onClick:()=>showModal(_cart.id),children:\"Xem chi ti\\u1EBFt\"})})]},_cart.id);});};console.log(cartsInCheckoutBills,\"cartsInCheckoutBills\");return/*#__PURE__*/_jsx(\"div\",{className:\"purchase-history-wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"purchase-history\",children:/*#__PURE__*/_jsx(\"div\",{className:\"purchase-history-table\",children:/*#__PURE__*/_jsx(\"div\",{className:\"purchase-history-table__table-grp\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"cart-page-shop-table__shop-table\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"cart-page-shop-table__thead\",children:/*#__PURE__*/_jsxs(\"tr\",{className:\"cart-page-shop-table__thead-tr\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"cart-page-shop-table__th2\",children:\"M\\xE3 \\u0111\\u01A1n h\\xE0ng\"}),/*#__PURE__*/_jsx(\"th\",{className:\"cart-page-shop-table__th3\",children:\"Ng\\xE0y \\u0111\\u1EB7t \\u0111\\u01A1n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"cart-page-shop-table__th4\",children:\"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"cart-page-shop-table__th6\",children:\"Gi\\xE1 tr\\u1ECB \\u0111\\u01A1n h\\xE0ng\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{className:\"cart-page-shop-table__tbody\",children:[renderDetail(paymentBills),/*#__PURE__*/_jsx(CartPurchase,{handleOk:handleOk,handleCancel:handleCancel,isModalOpen:isModalOpen,cartsInCheckoutBills:cartsInCheckoutBills})]})]})})})})});};export default PurchaseHistory;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","actFetchAllPaymentBills","Button","InputNumber","CartPurchase","jsx","_jsx","jsxs","_jsxs","PurchaseHistory","dispatch","paymentBills","state","payment","userInfo","user","isModalOpen","setIsModalOpen","cartsInCheckoutBills","setCartsInCheckoutBills","id","userId","checkoutBillsClone","showModal","indexThisBills","findIndex","_cart","carts","handleOk","handleCancel","formatNumber","num","numString","div","Math","floor","renderDetail","console","log","map","children","className","orderNumber","dateOfBill","totalMoney","onClick"],"sources":["D:/Front End/ReactJS/thien dang/client/src/components/PurchaseHistory/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport \"./style.scss\";\nimport { actFetchAllPaymentBills } from \"../../redux/features/payment/paymentSlice\";\nimport { Button, InputNumber } from \"antd\";\nimport CartPurchase from \"../CartPurchase\";\n\nconst PurchaseHistory = () => {\n  const dispatch = useDispatch();\n  const { paymentBills } = useSelector((state) => state.payment);\n  const userInfo = useSelector((state) => state.user.userInfo);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [cartsInCheckoutBills, setCartsInCheckoutBills] = useState([]);\n\n  useEffect(() => {\n    if (!userInfo.id) {\n      return;\n    }\n\n    dispatch(actFetchAllPaymentBills({\n      userId: userInfo.id\n    }));\n    // eslint-disable-next-line\n  }, [userInfo.id]);\n  const checkoutBillsClone = [...paymentBills];\n\n  const showModal = (id) => {\n    setIsModalOpen(true);\n\n    const indexThisBills = checkoutBillsClone.findIndex((_cart) => {\n      return _cart.id === id;\n    });\n    setCartsInCheckoutBills(checkoutBillsClone[indexThisBills].carts);\n  };\n\n  const handleOk = () => {\n    setIsModalOpen(false);\n  };\n  const handleCancel = () => {\n    setIsModalOpen(false);\n  };\n\n  const formatNumber = (num) => {\n    let numString = \"\";\n    while (num > 0) {\n      let div = num % 1000;\n      num = Math.floor(num / 1000);\n      if (num !== 0) {\n        if (div < 10) {\n          div = \"00\" + div;\n        } else if (div < 100) {\n          div = \"0\" + div;\n        }\n        numString = \".\" + div + numString;\n      } else {\n        numString = div + numString;\n      }\n    }\n    return numString;\n  };\n\n  const renderDetail = (paymentBills) => {\n    console.log(paymentBills, \"cartsInPaymentBillscartsInPaymentBills\");\n    return paymentBills?.map((_cart) => {\n      return (\n        <tr key={_cart.id}>\n          <td className=\"cart-page-shop-table__img-product\">\n            <p>{_cart.orderNumber}</p>\n          </td>\n          <td className=\"cart-page-shop-table__name-product\">\n            <p className=\"name\">{_cart.dateOfBill}</p>\n          </td>\n          <td className=\"cart-page-shop-table__price-product\">\n            <p className=\"name\">{_cart.payment}</p>\n          </td>\n          <td className=\"cart-page-shop-table__subtotal-product\">\n            {_cart.totalMoney}\n          </td>\n          <td className=\"cart-page-shop-table__subtotal-product\">\n            <Button onClick={() => showModal(_cart.id)}>Xem chi tiết</Button>\n          </td>\n        </tr>\n      );\n    });\n  };\n\n  console.log(cartsInCheckoutBills, \"cartsInCheckoutBills\");\n\n  return (\n    <div className=\"purchase-history-wrapper\">\n      <div className=\"purchase-history\">\n        <div className=\"purchase-history-table\">\n          <div className=\"purchase-history-table__table-grp\">\n            <table className=\"cart-page-shop-table__shop-table\">\n              <thead className=\"cart-page-shop-table__thead\">\n                <tr className=\"cart-page-shop-table__thead-tr\">\n                  <th className=\"cart-page-shop-table__th2\">Mã đơn hàng</th>\n                  <th className=\"cart-page-shop-table__th3\">Ngày đặt đơn</th>\n                  <th className=\"cart-page-shop-table__th4\">Phương thức thanh toán</th>\n                  <th className=\"cart-page-shop-table__th6\">Giá trị đơn hàng</th>\n                </tr>\n              </thead>\n              <tbody className=\"cart-page-shop-table__tbody\">\n                {renderDetail(paymentBills)}\n                <CartPurchase\n                  handleOk={handleOk}\n                  handleCancel={handleCancel}\n                  isModalOpen={isModalOpen}\n                  cartsInCheckoutBills={cartsInCheckoutBills}\n                />\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PurchaseHistory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}